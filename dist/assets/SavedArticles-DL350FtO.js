import{u as q,a as z,i as J,r,j as e,B as d,G as A,K as y,I as K,H as M,J as R,D as X,b as Z,d as $,e as ee}from"./index-BFVSuNBS.js";import{B as C}from"./badge-DZaAhHAm.js";import{T as D,F as se,A as ae,a as te,b as le,c as re}from"./ArticleViewer-YUjUT2OJ.js";import{g as ie,S as ne,A as ce,b as oe,d as de,e as he,f as xe,h as me,i as ue,j as ge,k as je}from"./alert-dialog-Bxq6_kRf.js";import{S as T,a as k,b as L,d as E,e as h,E as pe}from"./select-UIomGo4A.js";import{L as fe}from"./loader-circle-DnJb0dIx.js";import{A as ve}from"./arrow-left-M_JDR--f.js";import{B as Ne}from"./bookmark-CqJ7L7bN.js";import{C as we}from"./calendar-DtZTO_cH.js";const Ee=()=>{const{user:x}=q(),{toast:v}=z(),m=J(),[o,u]=r.useState([]),[g,B]=r.useState([]),[F,S]=r.useState(!0),[j,V]=r.useState(""),[p,U]=r.useState(""),[N,_]=r.useState("date"),[f,H]=r.useState("desc"),[n,w]=r.useState(null),[c,b]=r.useState(null);r.useEffect(()=>{if(!x){m("/");return}O()},[x,m]),r.useEffect(()=>{G()},[o,j,p,N,f]);const O=async()=>{if(x){S(!0);try{const s=await ie(x.id);u(s)}catch{v({title:"Error",description:"Failed to load saved articles. Please try again.",variant:"destructive"})}finally{S(!1)}}},G=()=>{let s=[...o];if(j.trim()){const t=j.toLowerCase();s=s.filter(a=>{var l,i;return a.headline.toLowerCase().includes(t)||a.topic.toLowerCase().includes(t)||((l=a.notes)==null?void 0:l.toLowerCase().includes(t))||((i=a.tags)==null?void 0:i.some(W=>W.toLowerCase().includes(t)))})}p&&(s=s.filter(t=>{var a;return(a=t.tags)==null?void 0:a.includes(p)})),s.sort((t,a)=>{let l,i;switch(N){case"date":l=new Date(t.saved_at),i=new Date(a.saved_at);break;case"title":l=t.headline.toLowerCase(),i=a.headline.toLowerCase();break;case"topic":l=t.topic.toLowerCase(),i=a.topic.toLowerCase();break;default:l=new Date(t.saved_at),i=new Date(a.saved_at)}return l<i?f==="asc"?-1:1:l>i?f==="asc"?1:-1:0}),B(s)},I=async()=>{if(!c)return;await je(c.id)?(u(t=>t.filter(a=>a.id!==c.id)),v({title:"Article Deleted",description:"The article has been removed from your saved articles."}),(n==null?void 0:n.id)===c.id&&w(null)):v({title:"Error",description:"Failed to delete article. Please try again.",variant:"destructive"}),b(null)},Y=()=>{const s=new Set;return o.forEach(t=>{var a;(a=t.tags)==null||a.forEach(l=>s.add(l))}),Array.from(s).sort()},P=(s,t)=>{u(a=>a.map(l=>l.id===s?{...l,notes:t}:l))},Q=(s,t)=>{u(a=>a.map(l=>l.id===s?{...l,tags:t}:l))};return F?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(fe,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Loading your saved articles..."})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:e.jsxs("div",{className:"container mx-auto p-6 max-w-6xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(d,{onClick:()=>m("/"),variant:"ghost",className:"mb-4",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Back to NewsGlide"]}),e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:"/lovable-uploads/4aa0d947-eb92-4247-965f-85f5d500d005.png",alt:"NewsGlide Logo",className:"h-8 w-8"}),e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Saved Articles"}),e.jsxs(C,{variant:"outline",className:"ml-2",children:[g.length," ",g.length===1?"article":"articles"]})]})}),e.jsx(A,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2 relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(K,{placeholder:"Search articles, topics, notes, or tags...",value:j,onChange:s=>V(s.target.value),className:"pl-10"})]}),e.jsxs(T,{value:p,onValueChange:U,children:[e.jsxs(k,{children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),e.jsx(L,{placeholder:"Filter by tag"})]}),e.jsxs(E,{children:[e.jsx(h,{value:"",children:"All tags"}),Y().map(s=>e.jsx(h,{value:s,children:s},s))]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(T,{value:N,onValueChange:s=>_(s),children:[e.jsxs(k,{children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),e.jsx(L,{})]}),e.jsxs(E,{children:[e.jsx(h,{value:"date",children:"Date Saved"}),e.jsx(h,{value:"title",children:"Title"}),e.jsx(h,{value:"topic",children:"Topic"})]})]}),e.jsx(d,{variant:"outline",size:"icon",onClick:()=>H(s=>s==="asc"?"desc":"asc"),children:f==="asc"?e.jsx(ae,{className:"h-4 w-4"}):e.jsx(te,{className:"h-4 w-4"})})]})]})})})]}),g.length===0?e.jsx(A,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:e.jsxs(y,{className:"p-12 text-center",children:[e.jsx(Ne,{className:"h-16 w-16 mx-auto mb-4 text-gray-300"}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-gray-600",children:o.length===0?"No Saved Articles Yet":"No Articles Match Your Filters"}),e.jsx("p",{className:"text-gray-500 mb-6",children:o.length===0?"Start exploring news and save articles that interest you!":"Try adjusting your search or filter criteria."}),o.length===0&&e.jsx(d,{onClick:()=>m("/"),children:"Explore News"})]})}):e.jsx("div",{className:"grid gap-6",children:g.map(s=>e.jsxs(A,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm hover:shadow-xl transition-all duration-300",children:[e.jsx(M,{children:e.jsx(R,{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2 line-clamp-2",children:s.headline}),e.jsxs("p",{className:"text-sm text-blue-600 font-medium mb-2",children:["Topic: ",s.topic]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(we,{className:"h-3 w-3"}),"Saved ",new Date(s.saved_at).toLocaleDateString()]}),s.tags&&s.tags.length>0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"h-3 w-3"}),s.tags.length," tags"]})]})]})})}),e.jsx(y,{children:e.jsxs("div",{className:"space-y-3",children:[s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1",children:s.tags.map((t,a)=>e.jsx(C,{variant:"secondary",className:"text-xs",children:t},a))}),s.notes&&e.jsx("div",{className:"bg-gray-50 rounded p-3",children:e.jsxs("p",{className:"text-sm text-gray-600 line-clamp-2",children:[e.jsx("span",{className:"font-medium",children:"Your notes:"})," ",s.notes]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(d,{onClick:()=>w(s),className:"flex-1",children:[e.jsx(pe,{className:"h-4 w-4 mr-2"}),"View Article"]}),e.jsx(d,{variant:"outline",onClick:()=>b(s),className:"text-red-600 hover:text-red-700",children:e.jsx(le,{className:"h-4 w-4"})})]})]})})]},s.id))}),e.jsx(X,{open:!!n,onOpenChange:()=>w(null),children:e.jsxs(Z,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsx($,{children:e.jsx(ee,{children:"Saved Article"})}),n&&e.jsx(re,{article:n,onUpdateNotes:s=>P(n.id,s),onUpdateTags:s=>Q(n.id,s),showEditableFields:!0})]})}),e.jsx(ce,{open:!!c,onOpenChange:()=>b(null),children:e.jsxs(oe,{children:[e.jsxs(de,{children:[e.jsx(he,{children:"Delete Saved Article"}),e.jsxs(xe,{children:['Are you sure you want to delete "',c==null?void 0:c.headline,'"? This action cannot be undone.']})]}),e.jsxs(me,{children:[e.jsx(ue,{children:"Cancel"}),e.jsx(ge,{onClick:I,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})})};export{Ee as default};
