import{j as e}from"./ui-vendor-Bw2ZGllB.js";import{u as s,h as r,r as a}from"./react-vendor-CMCxm6aa.js";import{c as t,s as i,f as n,g as l,u as c,B as o,C as d,b as m,d as x,e as h,l as p}from"./index-GErBfjjf.js";import{B as u}from"./badge-3VR0oUcD.js";import{A as j}from"./arrow-left-DfyKVgL0.js";import{B as f,V as g}from"./volume-2-VWyvQe_i.js";import"./utils-BjC949i_.js";
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w=t("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),b=t("Infinity",[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]]),y=t("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),N=()=>{const t=s(),N=r(),{user:v}=n(),{isProUser:P,subscriptionTier:k,dailySearchCount:E,searchLimit:S,refreshSubscription:C}=l(),{toast:I}=c();a.useEffect(()=>{const e=N.pathname,s=new URLSearchParams(N.search).get("session_id");"/subscription/success"===e&&s?(I({title:"Payment Successful! ðŸŽ‰",description:"Welcome to NewsGlide Pro! Your subscription is now active.",duration:5e3}),C(),t("/subscription",{replace:!0})):"/subscription/cancel"===e&&(I({title:"Payment Cancelled",description:"No worries! You can upgrade anytime.",variant:"destructive"}),t("/subscription",{replace:!0}))},[N,t,C,I]);const U=async()=>{if(v)try{I({title:"Opening customer portal...",description:"Redirecting to manage your subscription"});const{url:e}=await(async()=>{const{data:e,error:s}=await i.functions.invoke("create-portal-session",{body:{}});if(s)throw new Error(s.message||"Failed to create portal session");return e})();window.location.href=e}catch(e){I({title:"Portal Error",description:e instanceof Error?e.message:"Failed to open customer portal",variant:"destructive"})}},F=[{name:"Daily Searches",free:"5 per day",pro:"Unlimited",icon:y},{name:"Reading Levels",free:"Base + ELI5",pro:"Base + ELI5 + PhD",icon:f},{name:"Morgan Freeman Voice",free:"Not included",pro:"Included",icon:g},{name:"Article Saving",free:"Unlimited",pro:"Unlimited",icon:p},{name:"Search History",free:"Unlimited",pro:"Unlimited",icon:p}];return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:e.jsxs("div",{className:"container mx-auto px-6 py-12",children:[e.jsxs(o,{onClick:()=>t("/"),variant:"ghost",className:"mb-4",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Back to NewsGlide"]}),e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"Your Subscription"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Choose the plan that works best for your news consumption needs."})]}),v&&e.jsxs(d,{className:"max-w-2xl mx-auto mb-8 border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[e.jsx(m,{children:e.jsxs(x,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Current Plan"}),P?e.jsxs(u,{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white",children:[e.jsx(w,{className:"h-4 w-4 mr-1"}),"Pro Plan"]}):e.jsx(u,{variant:"outline",children:"Free Plan"})]})}),e.jsx(h,{children:P?e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-green-600 font-medium",children:"âœ… You have unlimited access to all Pro features!"}),e.jsx(o,{onClick:U,variant:"outline",className:"w-full",children:"Manage Subscription"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Searches Used Today:"}),e.jsxs("span",{className:"font-bold",children:[E,"/",S]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all",style:{width:E/S*100+"%"}})}),E>=S&&e.jsx("p",{className:"text-red-600 text-sm",children:"You've reached your daily limit. Upgrade to Pro for unlimited searches!"}),e.jsx(o,{onClick:async()=>{if(v)try{I({title:"Checking payment status...",description:"Looking for your recent payment"});const{data:e,error:s}=await i.functions.invoke("fix-subscription",{body:{email:v.email}});if(s)throw s;e.upgraded?(I({title:"Success! ðŸŽ‰",description:"Your Pro subscription is now active"}),await C()):I({title:"No recent payment found",description:"Please contact support if you've made a payment",variant:"destructive"})}catch(e){I({title:"Error checking payment",description:"Please try again or contact support",variant:"destructive"})}},variant:"outline",className:"w-full mt-2",children:"I already paid - activate my Pro subscription"})]})})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 max-w-4xl mx-auto mb-12",children:[e.jsxs(d,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[e.jsx(m,{children:e.jsxs(x,{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold mb-2",children:"Free"}),e.jsx("div",{className:"text-3xl font-bold text-gray-600",children:"$0"}),e.jsx("div",{className:"text-sm text-gray-500",children:"forever"})]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"5 searches per day"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Base + ELI5 reading levels"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Article saving & history"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Interactive Q&A"})]})]}),e.jsx(o,{variant:"outline",className:"w-full",disabled:!P,children:P?"Downgrade":"Current Plan"})]})]}),e.jsxs(d,{className:"border-0 shadow-lg bg-gradient-to-br from-blue-50 to-purple-50 relative",children:[e.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2",children:e.jsx(u,{className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white px-4 py-1",children:"Most Popular"})}),e.jsx(m,{children:e.jsxs(x,{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold mb-2 flex items-center justify-center gap-2",children:[e.jsx(w,{className:"h-6 w-6 text-yellow-500"}),"Pro"]}),e.jsx("div",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"$3"}),e.jsx("div",{className:"text-sm text-gray-500",children:"per month"})]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(b,{className:"h-4 w-4 text-blue-500"}),e.jsx("span",{children:"Unlimited searches"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-purple-500"}),e.jsx("span",{children:"PhD-level analysis"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Morgan Freeman narration"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"All Free features included"})]})]}),e.jsx(o,{onClick:P?U:async()=>{if(v)try{I({title:"Setting up your subscription...",description:"Please wait while we redirect you to checkout"});const{url:e}=await(async()=>{try{const{data:e,error:s}=await i.functions.invoke("create-checkout-session",{body:{}});if(s)throw new Error(s.message||"Failed to create checkout session");if(!(null==e?void 0:e.url))throw new Error("No checkout URL returned from payment service");return e}catch(e){const s=e instanceof Error?e.message:"Unknown error";if(s.includes("Invalid price ID"))throw new Error("Payment configuration error: Price ID not found in Stripe");if(s.includes("STRIPE_SECRET_KEY"))throw new Error("Payment configuration error: Stripe API key not configured");if(s.includes("Authentication error"))throw new Error("Authentication error: Please sign in again");throw e}})();if(!e||!e.startsWith("https://"))throw new Error(`Invalid checkout URL received: ${e}`);window.location.href=e}catch(e){const s=e instanceof Error?e.message:"Failed to start checkout process",r="localhost"===window.location.hostname;I({title:"Checkout Error",description:r?`${s} (Check console for details)`:s,variant:"destructive",duration:1e4})}else I({title:"Sign in required",description:"Please sign in to upgrade to Pro",variant:"destructive"})},className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:P?"Manage Subscription":"Upgrade to Pro"})]})]})]}),e.jsxs(d,{className:"max-w-4xl mx-auto border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[e.jsx(m,{children:e.jsx(x,{children:"Feature Comparison"})}),e.jsx(h,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4",children:"Feature"}),e.jsx("th",{className:"text-center py-3 px-4",children:"Free"}),e.jsx("th",{className:"text-center py-3 px-4",children:"Pro"})]})}),e.jsx("tbody",{children:F.map((s,r)=>e.jsxs("tr",{className:"border-b",children:[e.jsxs("td",{className:"py-3 px-4 flex items-center gap-2",children:[e.jsx(s.icon,{className:"h-4 w-4"}),s.name]}),e.jsx("td",{className:"text-center py-3 px-4",children:s.free}),e.jsx("td",{className:"text-center py-3 px-4 font-medium text-blue-600",children:s.pro})]},r))})]})})})]}),!v&&e.jsxs("div",{className:"text-center mt-8",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Sign in to manage your subscription"}),e.jsx(o,{onClick:()=>t("/"),children:"Go to Sign In"})]})]})})};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{N as default};
