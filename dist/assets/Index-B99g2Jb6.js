import{c as I,r as i,u as Te,a as Le,j as e,D as it,b as lt,d as ct,e as dt,L as Q,I as V,B as S,T as Ns,f as Ss,g as me,h as Ue,i as ks,k as ut,l as mt,A as ht,m as pt,n as xt,o as gt,p as ft,q as ds,s as ce,t as bt,v as oe,w as vt,P as re,x as De,y as te,z as Z,C as yt,E as U,F as ie,G as B,H as ee,J as se,K as H,M as Cs,N as wt,O as Ce,Q as jt,R as Nt,X as St}from"./index-BFVSuNBS.js";import{B as K}from"./badge-DZaAhHAm.js";import{E as Be,c as kt,C as de}from"./select-UIomGo4A.js";import{c as Ct,T as Pt,F as us,a as At,G as Et,E as Rt,S as ms,s as Tt}from"./alert-dialog-Bxq6_kRf.js";import{V as Ve,B as hs}from"./volume-2-ses9VVJo.js";import{L as G,C as ps}from"./loader-circle-DnJb0dIx.js";import{U as Ge}from"./user-3a9kj-DJ.js";import{B as Ps}from"./bookmark-CqJ7L7bN.js";import{S as Lt}from"./settings-DYzYyR90.js";import{s as Dt,R as Mt}from"./searchHistoryService-C_-0HUGn.js";import{S as Pe}from"./sparkles-KxbXQGQf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=I("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=I("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=I("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=I("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=I("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=I("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=I("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=I("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=I("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $t=I("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=I("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=I("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=I("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=I("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wt=I("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),gs=({isOpen:s,onClose:t,defaultTab:n="signin"})=>{const[a,r]=i.useState(n),[o,u]=i.useState(!1),[l,c]=i.useState(!1),{signIn:h,signUp:p,resetPassword:d}=Te(),{toast:m}=Le(),[g,y]=i.useState({email:"",password:""}),[N,w]=i.useState({email:"",password:"",fullName:"",confirmPassword:""}),[A,E]=i.useState(""),[j,L]=i.useState(!1),T=async v=>{v.preventDefault(),u(!0);const{error:P}=await h(g.email,g.password);P?m({title:"Sign in failed",description:P.message,variant:"destructive"}):(t(),y({email:"",password:""})),u(!1)},b=async v=>{if(v.preventDefault(),N.password!==N.confirmPassword){m({title:"Passwords don't match",description:"Please make sure your passwords match.",variant:"destructive"});return}if(N.password.length<6){m({title:"Password too short",description:"Password must be at least 6 characters long.",variant:"destructive"});return}u(!0);const{error:P}=await p(N.email,N.password,N.fullName);P?m({title:"Sign up failed",description:P.message,variant:"destructive"}):(m({title:"Check your email",description:"We've sent you a confirmation link to complete your registration.",duration:6e3}),t(),w({email:"",password:"",fullName:"",confirmPassword:""})),u(!1)},R=async v=>{v.preventDefault(),u(!0);const{error:P}=await d(A);P?m({title:"Reset failed",description:P.message,variant:"destructive"}):(m({title:"Check your email",description:"We've sent you a password reset link.",duration:5e3}),L(!1),E("")),u(!1)};return e.jsx(it,{open:s,onOpenChange:t,children:e.jsxs(lt,{className:"sm:max-w-md bg-white/95 backdrop-blur-sm border-0 shadow-2xl",children:[e.jsx(ct,{children:e.jsx(dt,{className:"text-center text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:j?"Reset Password":"Welcome to NewsGlide"})}),j?e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"reset-email",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{id:"reset-email",type:"email",placeholder:"Enter your email",value:A,onChange:v=>E(v.target.value),className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(S,{type:"submit",disabled:o,className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[o&&e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Send Reset Link"]}),e.jsx(S,{type:"button",variant:"outline",onClick:()=>L(!1),className:"flex-1",children:"Back"})]})]}):e.jsxs(Ns,{value:a,onValueChange:v=>r(v),children:[e.jsxs(Ss,{className:"grid w-full grid-cols-2 bg-gray-100/50",children:[e.jsx(me,{value:"signin",children:"Sign In"}),e.jsx(me,{value:"signup",children:"Sign Up"})]}),e.jsx(Ue,{value:"signin",className:"space-y-4",children:e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"signin-email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{id:"signin-email",type:"email",placeholder:"Enter your email",value:g.email,onChange:v=>y({...g,email:v.target.value}),className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"signin-password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{id:"signin-password",type:l?"text":"password",placeholder:"Enter your password",value:g.password,onChange:v=>y({...g,password:v.target.value}),className:"pl-10 pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l?e.jsx(We,{className:"h-4 w-4"}):e.jsx(Be,{className:"h-4 w-4"})})]})]}),e.jsxs(S,{type:"submit",disabled:o,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[o&&e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Sign In"]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{type:"button",onClick:()=>L(!0),className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Forgot your password?"})})]})}),e.jsx(Ue,{value:"signup",className:"space-y-4",children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"signup-name",children:"Full Name (Optional)"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{id:"signup-name",type:"text",placeholder:"Enter your full name",value:N.fullName,onChange:v=>w({...N,fullName:v.target.value}),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"signup-email",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{id:"signup-email",type:"email",placeholder:"Enter your email",value:N.email,onChange:v=>w({...N,email:v.target.value}),className:"pl-10",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"signup-password",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{id:"signup-password",type:l?"text":"password",placeholder:"Create a password (min. 6 chars)",value:N.password,onChange:v=>w({...N,password:v.target.value}),className:"pl-10 pr-10",required:!0}),e.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l?e.jsx(We,{className:"h-4 w-4"}):e.jsx(Be,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Q,{htmlFor:"signup-confirm",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{id:"signup-confirm",type:l?"text":"password",placeholder:"Confirm your password",value:N.confirmPassword,onChange:v=>w({...N,confirmPassword:v.target.value}),className:"pl-10",required:!0})]})]}),e.jsxs(S,{type:"submit",disabled:o,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[o&&e.jsx(G,{className:"mr-2 h-4 w-4 animate-spin"}),"Sign Up"]})]})})]})]})})},fs=({onOpenSavedArticles:s,onOpenHistory:t})=>{var l,c,h;const{user:n,signOut:a}=Te(),r=ks();if(!n)return null;const o=((l=n.user_metadata)==null?void 0:l.full_name)||((c=n.email)==null?void 0:c.split("@")[0])||"User",u=o.split(" ").map(p=>p[0]).join("").toUpperCase().slice(0,2);return e.jsxs(ut,{children:[e.jsx(mt,{asChild:!0,children:e.jsx(S,{variant:"ghost",className:"relative h-10 w-10 rounded-full hover:bg-white/10",children:e.jsxs(ht,{className:"h-9 w-9",children:[e.jsx(pt,{src:(h=n.user_metadata)==null?void 0:h.avatar_url,alt:o}),e.jsx(xt,{className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white text-sm font-medium",children:u})]})})}),e.jsxs(gt,{className:"w-56 bg-white/95 backdrop-blur-sm border-white/20",align:"end",children:[e.jsx(ft,{className:"font-normal",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("p",{className:"text-sm font-medium leading-none",children:o}),e.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:n.email})]})}),e.jsx(ds,{}),e.jsxs(ce,{onClick:()=>r("/profile"),className:"cursor-pointer",children:[e.jsx(Ge,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Profile"})]}),e.jsxs(ce,{onClick:()=>r("/search-history"),className:"cursor-pointer",children:[e.jsx(Ps,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Saved Articles & History"})]}),e.jsxs(ce,{onClick:()=>r("/preferences"),className:"cursor-pointer",children:[e.jsx(Lt,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Preferences"})]}),e.jsxs(ce,{onClick:()=>r("/subscription"),className:"cursor-pointer",children:[e.jsx("span",{className:"mr-2",children:"â­"}),e.jsx("span",{children:"Subscription"})]}),e.jsx(ds,{}),e.jsxs(ce,{onClick:a,className:"cursor-pointer text-red-600 focus:text-red-600",children:[e.jsx(zt,{className:"mr-2 h-4 w-4"}),e.jsx("span",{children:"Sign Out"})]})]})]})};function Vt(s,t){return i.useReducer((n,a)=>t[n][a]??n,s)}var qe="ScrollArea",[As,Mr]=bt(qe),[Gt,z]=As(qe),Es=i.forwardRef((s,t)=>{const{__scopeScrollArea:n,type:a="hover",dir:r,scrollHideDelay:o=600,...u}=s,[l,c]=i.useState(null),[h,p]=i.useState(null),[d,m]=i.useState(null),[g,y]=i.useState(null),[N,w]=i.useState(null),[A,E]=i.useState(0),[j,L]=i.useState(0),[T,b]=i.useState(!1),[R,v]=i.useState(!1),P=oe(t,O=>c(O)),M=vt(r);return e.jsx(Gt,{scope:n,type:a,dir:M,scrollHideDelay:o,scrollArea:l,viewport:h,onViewportChange:p,content:d,onContentChange:m,scrollbarX:g,onScrollbarXChange:y,scrollbarXEnabled:T,onScrollbarXEnabledChange:b,scrollbarY:N,onScrollbarYChange:w,scrollbarYEnabled:R,onScrollbarYEnabledChange:v,onCornerWidthChange:E,onCornerHeightChange:L,children:e.jsx(re.div,{dir:M,...u,ref:P,style:{position:"relative","--radix-scroll-area-corner-width":A+"px","--radix-scroll-area-corner-height":j+"px",...s.style}})})});Es.displayName=qe;var Rs="ScrollAreaViewport",Ts=i.forwardRef((s,t)=>{const{__scopeScrollArea:n,children:a,asChild:r,nonce:o,...u}=s,l=z(Rs,n),c=i.useRef(null),h=oe(t,c,l.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:o}),e.jsx(re.div,{"data-radix-scroll-area-viewport":"",...u,asChild:r,ref:h,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...s.style},children:tr({asChild:r,children:a},p=>e.jsx("div",{"data-radix-scroll-area-content":"",ref:l.onContentChange,style:{minWidth:l.scrollbarXEnabled?"fit-content":void 0},children:p}))})]})});Ts.displayName=Rs;var W="ScrollAreaScrollbar",Ye=i.forwardRef((s,t)=>{const{forceMount:n,...a}=s,r=z(W,s.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:u}=r,l=s.orientation==="horizontal";return i.useEffect(()=>(l?o(!0):u(!0),()=>{l?o(!1):u(!1)}),[l,o,u]),r.type==="hover"?e.jsx(qt,{...a,ref:t,forceMount:n}):r.type==="scroll"?e.jsx(Yt,{...a,ref:t,forceMount:n}):r.type==="auto"?e.jsx(Ls,{...a,ref:t,forceMount:n}):r.type==="always"?e.jsx(Xe,{...a,ref:t}):null});Ye.displayName=W;var qt=i.forwardRef((s,t)=>{const{forceMount:n,...a}=s,r=z(W,s.__scopeScrollArea),[o,u]=i.useState(!1);return i.useEffect(()=>{const l=r.scrollArea;let c=0;if(l){const h=()=>{window.clearTimeout(c),u(!0)},p=()=>{c=window.setTimeout(()=>u(!1),r.scrollHideDelay)};return l.addEventListener("pointerenter",h),l.addEventListener("pointerleave",p),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",h),l.removeEventListener("pointerleave",p)}}},[r.scrollArea,r.scrollHideDelay]),e.jsx(De,{present:n||o,children:e.jsx(Ls,{"data-state":o?"visible":"hidden",...a,ref:t})})}),Yt=i.forwardRef((s,t)=>{const{forceMount:n,...a}=s,r=z(W,s.__scopeScrollArea),o=s.orientation==="horizontal",u=Ie(()=>c("SCROLL_END"),100),[l,c]=Vt("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return i.useEffect(()=>{if(l==="idle"){const h=window.setTimeout(()=>c("HIDE"),r.scrollHideDelay);return()=>window.clearTimeout(h)}},[l,r.scrollHideDelay,c]),i.useEffect(()=>{const h=r.viewport,p=o?"scrollLeft":"scrollTop";if(h){let d=h[p];const m=()=>{const g=h[p];d!==g&&(c("SCROLL"),u()),d=g};return h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[r.viewport,o,c,u]),e.jsx(De,{present:n||l!=="hidden",children:e.jsx(Xe,{"data-state":l==="hidden"?"hidden":"visible",...a,ref:t,onPointerEnter:te(s.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:te(s.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),Ls=i.forwardRef((s,t)=>{const n=z(W,s.__scopeScrollArea),{forceMount:a,...r}=s,[o,u]=i.useState(!1),l=s.orientation==="horizontal",c=Ie(()=>{if(n.viewport){const h=n.viewport.offsetWidth<n.viewport.scrollWidth,p=n.viewport.offsetHeight<n.viewport.scrollHeight;u(l?h:p)}},10);return ne(n.viewport,c),ne(n.content,c),e.jsx(De,{present:a||o,children:e.jsx(Xe,{"data-state":o?"visible":"hidden",...r,ref:t})})}),Xe=i.forwardRef((s,t)=>{const{orientation:n="vertical",...a}=s,r=z(W,s.__scopeScrollArea),o=i.useRef(null),u=i.useRef(0),[l,c]=i.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=zs(l.viewport,l.content),p={...a,sizes:l,onSizesChange:c,hasThumb:h>0&&h<1,onThumbChange:m=>o.current=m,onThumbPointerUp:()=>u.current=0,onThumbPointerDown:m=>u.current=m};function d(m,g){return er(m,u.current,l,g)}return n==="horizontal"?e.jsx(Xt,{...p,ref:t,onThumbPositionChange:()=>{if(r.viewport&&o.current){const m=r.viewport.scrollLeft,g=bs(m,l,r.dir);o.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:m=>{r.viewport&&(r.viewport.scrollLeft=m)},onDragScroll:m=>{r.viewport&&(r.viewport.scrollLeft=d(m,r.dir))}}):n==="vertical"?e.jsx(Kt,{...p,ref:t,onThumbPositionChange:()=>{if(r.viewport&&o.current){const m=r.viewport.scrollTop,g=bs(m,l);o.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:m=>{r.viewport&&(r.viewport.scrollTop=m)},onDragScroll:m=>{r.viewport&&(r.viewport.scrollTop=d(m))}}):null}),Xt=i.forwardRef((s,t)=>{const{sizes:n,onSizesChange:a,...r}=s,o=z(W,s.__scopeScrollArea),[u,l]=i.useState(),c=i.useRef(null),h=oe(t,c,o.onScrollbarXChange);return i.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),e.jsx(Ms,{"data-orientation":"horizontal",...r,ref:h,sizes:n,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Me(n)+"px",...s.style},onThumbPointerDown:p=>s.onThumbPointerDown(p.x),onDragScroll:p=>s.onDragScroll(p.x),onWheelScroll:(p,d)=>{if(o.viewport){const m=o.viewport.scrollLeft+p.deltaX;s.onWheelScroll(m),_s(m,d)&&p.preventDefault()}},onResize:()=>{c.current&&o.viewport&&u&&a({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Ee(u.paddingLeft),paddingEnd:Ee(u.paddingRight)}})}})}),Kt=i.forwardRef((s,t)=>{const{sizes:n,onSizesChange:a,...r}=s,o=z(W,s.__scopeScrollArea),[u,l]=i.useState(),c=i.useRef(null),h=oe(t,c,o.onScrollbarYChange);return i.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),e.jsx(Ms,{"data-orientation":"vertical",...r,ref:h,sizes:n,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Me(n)+"px",...s.style},onThumbPointerDown:p=>s.onThumbPointerDown(p.y),onDragScroll:p=>s.onDragScroll(p.y),onWheelScroll:(p,d)=>{if(o.viewport){const m=o.viewport.scrollTop+p.deltaY;s.onWheelScroll(m),_s(m,d)&&p.preventDefault()}},onResize:()=>{c.current&&o.viewport&&u&&a({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Ee(u.paddingTop),paddingEnd:Ee(u.paddingBottom)}})}})}),[Jt,Ds]=As(W),Ms=i.forwardRef((s,t)=>{const{__scopeScrollArea:n,sizes:a,hasThumb:r,onThumbChange:o,onThumbPointerUp:u,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:h,onWheelScroll:p,onResize:d,...m}=s,g=z(W,n),[y,N]=i.useState(null),w=oe(t,P=>N(P)),A=i.useRef(null),E=i.useRef(""),j=g.viewport,L=a.content-a.viewport,T=Z(p),b=Z(c),R=Ie(d,10);function v(P){if(A.current){const M=P.clientX-A.current.left,O=P.clientY-A.current.top;h({x:M,y:O})}}return i.useEffect(()=>{const P=M=>{const O=M.target;(y==null?void 0:y.contains(O))&&T(M,L)};return document.addEventListener("wheel",P,{passive:!1}),()=>document.removeEventListener("wheel",P,{passive:!1})},[j,y,L,T]),i.useEffect(b,[a,b]),ne(y,R),ne(g.content,R),e.jsx(Jt,{scope:n,scrollbar:y,hasThumb:r,onThumbChange:Z(o),onThumbPointerUp:Z(u),onThumbPositionChange:b,onThumbPointerDown:Z(l),children:e.jsx(re.div,{...m,ref:w,style:{position:"absolute",...m.style},onPointerDown:te(s.onPointerDown,P=>{P.button===0&&(P.target.setPointerCapture(P.pointerId),A.current=y.getBoundingClientRect(),E.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),v(P))}),onPointerMove:te(s.onPointerMove,v),onPointerUp:te(s.onPointerUp,P=>{const M=P.target;M.hasPointerCapture(P.pointerId)&&M.releasePointerCapture(P.pointerId),document.body.style.webkitUserSelect=E.current,g.viewport&&(g.viewport.style.scrollBehavior=""),A.current=null})})})}),Ae="ScrollAreaThumb",Is=i.forwardRef((s,t)=>{const{forceMount:n,...a}=s,r=Ds(Ae,s.__scopeScrollArea);return e.jsx(De,{present:n||r.hasThumb,children:e.jsx(Qt,{ref:t,...a})})}),Qt=i.forwardRef((s,t)=>{const{__scopeScrollArea:n,style:a,...r}=s,o=z(Ae,n),u=Ds(Ae,n),{onThumbPositionChange:l}=u,c=oe(t,d=>u.onThumbChange(d)),h=i.useRef(),p=Ie(()=>{h.current&&(h.current(),h.current=void 0)},100);return i.useEffect(()=>{const d=o.viewport;if(d){const m=()=>{if(p(),!h.current){const g=sr(d,l);h.current=g,l()}};return l(),d.addEventListener("scroll",m),()=>d.removeEventListener("scroll",m)}},[o.viewport,p,l]),e.jsx(re.div,{"data-state":u.hasThumb?"visible":"hidden",...r,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:te(s.onPointerDownCapture,d=>{const g=d.target.getBoundingClientRect(),y=d.clientX-g.left,N=d.clientY-g.top;u.onThumbPointerDown({x:y,y:N})}),onPointerUp:te(s.onPointerUp,u.onThumbPointerUp)})});Is.displayName=Ae;var Ke="ScrollAreaCorner",Fs=i.forwardRef((s,t)=>{const n=z(Ke,s.__scopeScrollArea),a=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&a?e.jsx(Zt,{...s,ref:t}):null});Fs.displayName=Ke;var Zt=i.forwardRef((s,t)=>{const{__scopeScrollArea:n,...a}=s,r=z(Ke,n),[o,u]=i.useState(0),[l,c]=i.useState(0),h=!!(o&&l);return ne(r.scrollbarX,()=>{var d;const p=((d=r.scrollbarX)==null?void 0:d.offsetHeight)||0;r.onCornerHeightChange(p),c(p)}),ne(r.scrollbarY,()=>{var d;const p=((d=r.scrollbarY)==null?void 0:d.offsetWidth)||0;r.onCornerWidthChange(p),u(p)}),h?e.jsx(re.div,{...a,ref:t,style:{width:o,height:l,position:"absolute",right:r.dir==="ltr"?0:void 0,left:r.dir==="rtl"?0:void 0,bottom:0,...s.style}}):null});function Ee(s){return s?parseInt(s,10):0}function zs(s,t){const n=s/t;return isNaN(n)?0:n}function Me(s){const t=zs(s.viewport,s.content),n=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,a=(s.scrollbar.size-n)*t;return Math.max(a,18)}function er(s,t,n,a="ltr"){const r=Me(n),o=r/2,u=t||o,l=r-u,c=n.scrollbar.paddingStart+u,h=n.scrollbar.size-n.scrollbar.paddingEnd-l,p=n.content-n.viewport,d=a==="ltr"?[0,p]:[p*-1,0];return Os([c,h],d)(s)}function bs(s,t,n="ltr"){const a=Me(t),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,o=t.scrollbar.size-r,u=t.content-t.viewport,l=o-a,c=n==="ltr"?[0,u]:[u*-1,0],h=kt(s,c);return Os([0,u],[0,l])(h)}function Os(s,t){return n=>{if(s[0]===s[1]||t[0]===t[1])return t[0];const a=(t[1]-t[0])/(s[1]-s[0]);return t[0]+a*(n-s[0])}}function _s(s,t){return s>0&&s<t}var sr=(s,t=()=>{})=>{let n={left:s.scrollLeft,top:s.scrollTop},a=0;return function r(){const o={left:s.scrollLeft,top:s.scrollTop},u=n.left!==o.left,l=n.top!==o.top;(u||l)&&t(),n=o,a=window.requestAnimationFrame(r)}(),()=>window.cancelAnimationFrame(a)};function Ie(s,t){const n=Z(s),a=i.useRef(0);return i.useEffect(()=>()=>window.clearTimeout(a.current),[]),i.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(n,t)},[n,t])}function ne(s,t){const n=Z(t);yt(()=>{let a=0;if(s){const r=new ResizeObserver(()=>{cancelAnimationFrame(a),a=window.requestAnimationFrame(n)});return r.observe(s),()=>{window.cancelAnimationFrame(a),r.unobserve(s)}}},[s,n])}function tr(s,t){const{asChild:n,children:a}=s;if(!n)return typeof t=="function"?t(a):t;const r=i.Children.only(a);return i.cloneElement(r,{children:typeof t=="function"?t(r.props.children):t})}var $s=Es,rr=Ts,ar=Fs;const Hs=i.forwardRef(({className:s,children:t,...n},a)=>e.jsxs($s,{ref:a,className:U("relative overflow-hidden",s),...n,children:[e.jsx(rr,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(Us,{}),e.jsx(ar,{})]}));Hs.displayName=$s.displayName;const Us=i.forwardRef(({className:s,orientation:t="vertical",...n},a)=>e.jsx(Ye,{ref:a,orientation:t,className:U("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",s),...n,children:e.jsx(Is,{className:"relative flex-1 rounded-full bg-border"})}));Us.displayName=Ye.displayName;function Bs(s){return s&&s.type==="message"&&Array.isArray(s.content)}function nr(s){console.log("Attempting to parse JSON, length:",s.length);let t=s.trim();t=t.replace(/```(?:json)?\s*/gi,"").replace(/```$/g,"");const n=t.indexOf("{"),a=t.lastIndexOf("}");n>=0&&a>n&&(t=t.slice(n,a+1));try{const r=JSON.parse(t);return console.log("JSON parse successful"),r}catch(r){console.log("Direct parse failed:",r.message)}try{let r=t,o=0,u=0,l=!1,c=!1,h=0;for(let d=0;d<r.length;d++){const m=r[d];if(c){c=!1;continue}if(m==="\\"){c=!0;continue}m==='"'&&!c&&(l=!l),l||(m==="{"?o++:m==="}"?(o--,o===0&&(h=d+1)):m==="]"&&u--)}if(h>0)r=r.slice(0,h);else{for(l&&(r+='"');u>0;)r+="]",u--;for(;o>0;)r+="}",o--}r=r.replace(/,(\s*[}\]])/g,"$1");const p=JSON.parse(r);return console.log("JSON repair successful"),p}catch(r){console.log("JSON repair failed:",r.message)}throw new Error(`JSON parsing failed after all repair attempts. Preview: ${s.slice(0,200)}...`)}async function or(s,t){var r,o,u,l,c,h,p,d,m,g,y,N;let a=0;for(;a<=2;)try{if(console.log(`Calling Supabase Edge Function for topic: ${s.topic} (attempt ${a+1})`),t!=null&&t.aborted)throw new Error("Request cancelled");const{data:w,error:A}=await ie.functions.invoke("news-synthesis",{body:{topic:s.topic,targetOutlets:s.targetOutlets,freshnessHorizonHours:s.freshnessHorizonHours||48,includePhdAnalysis:s.includePhdAnalysis||!1}});if(A){if(console.error("Supabase function error:",A),(r=A.message)!=null&&r.includes("Edge Function returned a non-2xx status code")){if(a<2){console.log(`Server error detected, retrying in ${(a+1)*2} seconds...`),await new Promise(b=>setTimeout(b,(a+1)*2e3)),a++;continue}throw new Error("Service temporarily unavailable. Please try again in a few moments.")}throw new Error(A.message||"Failed to call news synthesis function")}if(!w){if(a<2){console.log("No data returned, retrying..."),await new Promise(b=>setTimeout(b,2e3)),a++;continue}throw new Error("No data returned from news synthesis function")}if(w.error)switch(console.error("Edge function returned structured error:",w),w.code){case"NO_SOURCES":throw new Error("No current news articles found for this topic. This might be a very niche topic or you may need to use different search terms.");case"INSUFFICIENT_SOURCES":throw new Error("No reliable sources found for this keyword. Try rephrasing or using a narrower topic.");case"RATE_LIMIT":if(a<2){console.log("Rate limit hit, retrying..."),await new Promise(b=>setTimeout(b,3e3)),a++;continue}throw new Error("Rate limit reached. Please wait a moment and try again.");case"OPENAI":throw new Error("Analysis service temporarily unavailable. Please try again in a few moments.");case"PARSE_ERROR":throw new Error("Analysis failed due to response format issues. Please try again.");case"CONFIG_ERROR":throw new Error("Search service configuration error. Please make sure search API keys are properly configured.");case"TIMEOUT":throw new Error("The analysis is taking longer than expected. Please try again or use a simpler search term.");case"TOKEN_LIMIT":throw new Error("The analysis request was too complex. Please try a simpler or more specific topic.");default:throw new Error(w.message||"Analysis failed. Please try again.")}console.log("Response received from Edge Function");let E="";if(w.output&&Array.isArray(w.output)){const b=w.output.find(Bs);b&&b.content&&b.content[0]&&b.content[0].text&&(E=b.content[0].text)}if(!E&&w.output_text&&(E=w.output_text),!E)throw console.error("No output text found in response:",w),new Error("No output text in response");console.log("Output text length:",E.length);let j;try{j=nr(E)}catch(b){throw console.error("All JSON parsing strategies failed:",b),new Error(`Failed to parse news data: ${b.message}`)}if(!j.sources||!Array.isArray(j.sources)||j.sources.length<3)throw new Error("No current news sources found for this topic. Try a different search term.");const L=j.sources.filter(b=>b.url&&b.url.startsWith("http")&&b.outlet&&b.headline);if(L.length<3)throw new Error("No reliable current news sources found for this topic. Try rephrasing your search.");const T={topic:j.topic||s.topic,headline:(j.headline||`Current News: ${s.topic}`).substring(0,100),generatedAtUTC:j.generatedAtUTC||new Date().toISOString(),confidenceLevel:j.confidenceLevel||"Medium",topicHottness:j.topicHottness||"Medium",summaryPoints:Array.isArray(j.summaryPoints)?j.summaryPoints.slice(0,5).map(b=>String(b).substring(0,150)):["Analysis based on current news sources"],sourceAnalysis:{narrativeConsistency:{score:((u=(o=j.sourceAnalysis)==null?void 0:o.narrativeConsistency)==null?void 0:u.score)||5,label:((c=(l=j.sourceAnalysis)==null?void 0:l.narrativeConsistency)==null?void 0:c.label)||"Medium"},publicInterest:{score:((p=(h=j.sourceAnalysis)==null?void 0:h.publicInterest)==null?void 0:p.score)||5,label:((m=(d=j.sourceAnalysis)==null?void 0:d.publicInterest)==null?void 0:m.label)||"Medium"}},disagreements:Array.isArray(j.disagreements)?j.disagreements.slice(0,3):[],article:{base:((g=j.article)==null?void 0:g.base)||"Analysis based on current news sources.",eli5:((y=j.article)==null?void 0:y.eli5)||"Simple explanation based on news.",phd:((N=j.article)==null?void 0:N.phd)||"Advanced technical analysis based on news sources."},keyQuestions:Array.isArray(j.keyQuestions)?j.keyQuestions.slice(0,5):["What are the key developments?"],sources:L.slice(0,8).map((b,R)=>({id:b.id||`source_${R+1}`,outlet:b.outlet||"Unknown",type:b.type||"Online Media",url:b.url,headline:String(b.headline||"No headline").substring(0,100),publishedAt:b.publishedAt||new Date().toISOString(),analysisNote:String(b.analysisNote||"Current news source").substring(0,150)})),missingSources:Array.isArray(j.missingSources)?j.missingSources:[]};return console.log(`Successfully synthesized news with ${T.sources.length} real current sources`),T}catch(w){if(console.error(`Synthesis attempt ${a+1} failed:`,w),w instanceof Error&&(w.name==="AbortError"||w.message==="Request cancelled"))throw w;if(a>=2)throw console.error("All retry attempts exhausted"),w;await new Promise(A=>setTimeout(A,2e3)),a++}throw new Error("Unexpected end of retry loop")}async function vs(s){var t,n;try{console.log(`Asking question about ${s.topic}: ${s.question}`);const{data:a,error:r}=await ie.functions.invoke("news-qa",{body:s});if(r)throw console.error("Q&A function error:",r),new Error(r.message||"Failed to get answer");if(!a||a.error)throw new Error((a==null?void 0:a.message)||"Failed to process question");if(a.answer)return a.answer;if(a.output&&Array.isArray(a.output)){const o=a.output.find(Bs);if((n=(t=o==null?void 0:o.content)==null?void 0:t[0])!=null&&n.text)return o.content[0].text}throw new Error("Invalid response format")}catch(a){throw console.error("Question error:",a),a}}async function ys(){try{const s=Date.now();console.log(`Fetching trending topics at ${s}...`);const{data:t,error:n}=await ie.functions.invoke("trending-topics",{body:{timestamp:s}});if(n)throw console.error("Edge function error:",n),n;console.log("Trending response:",t),t!=null&&t.fallback&&console.warn("Got fallback topics - edge function may be failing");const r=((t==null?void 0:t.topics)||[]).filter(o=>o&&typeof o=="string"&&o.length>5&&!o.includes("undefined")&&!o.match(/trial\s+trial|news\s+news/i));return r.length>0?r:["Technology news","Political updates","Business today","World events"]}catch(s){return console.error("fetchTrendingTopics failed:",s),["Latest news","Tech updates","Politics today","Business news"]}}function ir(s,t=[]){let n=[];function a(o,u){const l=i.createContext(u),c=n.length;n=[...n,u];function h(d){const{scope:m,children:g,...y}=d,N=(m==null?void 0:m[s][c])||l,w=i.useMemo(()=>y,Object.values(y));return e.jsx(N.Provider,{value:w,children:g})}function p(d,m){const g=(m==null?void 0:m[s][c])||l,y=i.useContext(g);if(y)return y;if(u!==void 0)return u;throw new Error(`\`${d}\` must be used within \`${o}\``)}return h.displayName=o+"Provider",[h,p]}const r=()=>{const o=n.map(u=>i.createContext(u));return function(l){const c=(l==null?void 0:l[s])||o;return i.useMemo(()=>({[`__scope${s}`]:{...l,[s]:c}}),[l,c])}};return r.scopeName=s,[a,lr(r,...t)]}function lr(...s){const t=s[0];if(s.length===1)return t;const n=()=>{const a=s.map(r=>({useScope:r(),scopeName:r.scopeName}));return function(o){const u=a.reduce((l,{useScope:c,scopeName:h})=>{const d=c(o)[`__scope${h}`];return{...l,...d}},{});return i.useMemo(()=>({[`__scope${t.scopeName}`]:u}),[u])}};return n.scopeName=t.scopeName,n}var Je="Progress",Qe=100,[cr,Ir]=ir(Je),[dr,ur]=cr(Je),Ws=i.forwardRef((s,t)=>{const{__scopeProgress:n,value:a=null,max:r,getValueLabel:o=mr,...u}=s;(r||r===0)&&!ws(r)&&console.error(hr(`${r}`,"Progress"));const l=ws(r)?r:Qe;a!==null&&!js(a,l)&&console.error(pr(`${a}`,"Progress"));const c=js(a,l)?a:null,h=Re(c)?o(c,l):void 0;return e.jsx(dr,{scope:n,value:c,max:l,children:e.jsx(re.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Re(c)?c:void 0,"aria-valuetext":h,role:"progressbar","data-state":qs(c,l),"data-value":c??void 0,"data-max":l,...u,ref:t})})});Ws.displayName=Je;var Vs="ProgressIndicator",Gs=i.forwardRef((s,t)=>{const{__scopeProgress:n,...a}=s,r=ur(Vs,n);return e.jsx(re.div,{"data-state":qs(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...a,ref:t})});Gs.displayName=Vs;function mr(s,t){return`${Math.round(s/t*100)}%`}function qs(s,t){return s==null?"indeterminate":s===t?"complete":"loading"}function Re(s){return typeof s=="number"}function ws(s){return Re(s)&&!isNaN(s)&&s>0}function js(s,t){return Re(s)&&!isNaN(s)&&s<=t&&s>=0}function hr(s,t){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Qe}\`.`}function pr(s,t){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Qe} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ys=Ws,xr=Gs;const Xs=i.forwardRef(({className:s,value:t,...n},a)=>e.jsx(Ys,{ref:a,className:U("relative h-4 w-full overflow-hidden rounded-full bg-secondary",s),...n,children:e.jsx(xr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Xs.displayName=Ys.displayName;async function gr(s){const{data:t,error:n}=await ie.functions.invoke("text-to-speech",{body:{text:s}});if(n)throw new Error(n.message||"Failed to generate speech");return t}const fr=({text:s,articleType:t,topic:n,canUseFeature:a=!0})=>{const[r,o]=i.useState(!1),[u,l]=i.useState(!1),[c,h]=i.useState(null),[p,d]=i.useState(0),[m,g]=i.useState(0),y=i.useRef(null),{toast:N}=Le(),w=b=>{const R=Math.floor(b/60),v=Math.floor(b%60);return`${R}:${v.toString().padStart(2,"0")}`},A=async()=>{if(!a){N({title:"Pro Feature",description:"Morgan Freeman narration is only available for Pro users. Upgrade to unlock!",variant:"destructive"});return}if(c&&y.current){E();return}o(!0);try{const b=s.replace(/\[.*?\]/g,"").replace(/\n\n+/g,". ").trim(),R=await gr(b);h(R.audio);const v=new Audio(`data:audio/mp3;base64,${R.audio}`);y.current=v,v.addEventListener("loadedmetadata",()=>{g(v.duration)}),v.addEventListener("timeupdate",()=>{v.duration&&d(v.currentTime/v.duration*100)}),v.addEventListener("ended",()=>{l(!1),d(0)}),v.addEventListener("error",P=>{console.error("Audio playback error:",P),N({title:"Playback Error",description:"Failed to play audio. Please try again.",variant:"destructive"}),l(!1)}),await v.play(),l(!0),N({title:"Audio Generated",description:"Now playing with Morgan Freeman's voice"})}catch(b){console.error("TTS error:",b),N({title:"Generation Error",description:b.message||"Failed to generate speech",variant:"destructive"})}finally{o(!1)}},E=()=>{y.current&&(u?(y.current.pause(),l(!1)):(y.current.play(),l(!0)))},j=()=>{if(!c)return;const R=`newsglide-${n.replace(/[^a-z0-9]/gi,"-").toLowerCase()}-${t}-morgan-freeman.mp3`,v=document.createElement("a");v.href=`data:audio/mp3;base64,${c}`,v.download=R,v.click()};i.useEffect(()=>()=>{y.current&&(y.current.pause(),y.current=null)},[]);const L=s.length,T=Math.ceil(L/1e3);return e.jsxs(B,{className:"border-0 shadow-lg bg-gradient-to-br from-purple-50 to-blue-50",children:[e.jsx(ee,{children:e.jsxs(se,{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-purple-600"}),"Listen with Morgan Freeman"]}),e.jsxs("span",{className:"text-sm font-normal text-gray-600",children:["~",T," min"]})]})}),e.jsx(H,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white/60 rounded-lg",children:[e.jsx("span",{className:"text-2xl",children:"ðŸŽ­"}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-semibold",children:"Morgan Freeman"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Iconic narrator voice"})]})]}),c&&m>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Xs,{value:p,className:"h-2"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[e.jsx("span",{children:w(p/100*m)}),e.jsx("span",{children:w(m)})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{onClick:A,disabled:r||!a,className:`flex-1 ${a?"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:r?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating Audio..."]}):u?e.jsxs(e.Fragment,{children:[e.jsx(_t,{className:"h-4 w-4 mr-2"}),"Pause"]}):e.jsxs(e.Fragment,{children:[e.jsx($t,{className:"h-4 w-4 mr-2"}),c?"Resume":a?"Play with Morgan Freeman":"Morgan Freeman (Pro)"]})}),c&&e.jsx(S,{onClick:j,variant:"outline",size:"icon",title:"Download audio",children:e.jsx(It,{className:"h-4 w-4"})})]}),L>5e3&&e.jsx("p",{className:"text-xs text-amber-600 italic text-center",children:"âš ï¸ Text exceeds 5000 characters. Only first 5000 will be narrated."}),e.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Powered by ElevenLabs AI"})]})})]})},he=[{id:"trump",name:"Donald Trump",title:"45th & 47th President of the United States",traits:{speakingStyle:["repetitive","superlative","confrontational","simple language"],keyPhrases:["tremendous","nobody knows more than me","fake news","very very","believe me"],positions:["america first","border security","business-friendly","anti-establishment"],temperament:"aggressive"},systemPrompt:'You are Donald Trump. Speak with absolute confidence and use superlatives frequently ("tremendous", "incredible", "the best"). Repeat key phrases for emphasis. Be confrontational and dismissive of opposing views. Use simple, direct language. Often reference your business experience and "winning". Criticize mainstream media. Be bombastic and larger-than-life in your responses. Use phrases like "believe me", "nobody knows more than me about this", and "very very" frequently.'},{id:"musk",name:"Elon Musk",title:"CEO of Tesla, SpaceX & X",traits:{speakingStyle:["technical","visionary","meme-aware","philosophical"],keyPhrases:["first principles","orders of magnitude","simulation","mars","sustainable"],positions:["technological progress","free speech","space exploration","AI safety"],temperament:"analytical"},systemPrompt:`You are Elon Musk. Focus on first principles thinking and breaking down complex problems. Reference technological solutions and exponential improvements. Be philosophical about humanity's future and frequently mention Mars colonization. Use terms like "orders of magnitude better" and discuss sustainable energy. Be somewhat contrarian and willing to challenge conventional wisdom. Reference simulation theory occasionally. Speak with technical precision but also grand vision.`},{id:"harris",name:"Kamala Harris",title:"Vice President of the United States",traits:{speakingStyle:["measured","prosecutorial","inclusive","policy-focused"],keyPhrases:["let me be clear","the american people","justice","equity"],positions:["criminal justice reform","reproductive rights","climate action","equality"],temperament:"measured"},systemPrompt:'You are Kamala Harris. Speak with prosecutorial precision and focus on policy details. Use phrases like "let me be clear" and "the American people deserve". Emphasize justice, equity, and inclusive policies. Reference your background as a prosecutor and Senator. Be measured but firm in your positions. Focus on concrete policy solutions and their impact on working families. Use "we must" and "it is time" frequently when calling for action.'},{id:"aoc",name:"Alexandria Ocasio-Cortez",title:"U.S. Representative, New York",traits:{speakingStyle:["passionate","direct","youthful","social media savvy"],keyPhrases:["working families","climate crisis","green new deal","economic justice"],positions:["progressive economics","climate action","social justice","medicare for all"],temperament:"passionate"},systemPrompt:'You are Alexandria Ocasio-Cortez (AOC). Speak passionately about economic and social justice. Focus on "working families" and systemic inequality. Be direct and unafraid to challenge establishment politics. Reference the climate crisis as an urgent existential threat. Use accessible language that connects with young people. Be bold in proposing progressive solutions like the Green New Deal. Show frustration with incremental change and demand transformative action.'},{id:"xi",name:"Xi Jinping",title:"President of China",traits:{speakingStyle:["diplomatic","measured","strategic","philosophical"],keyPhrases:["common prosperity","win-win cooperation","shared future","peaceful development"],positions:["economic development","national sovereignty","multilateralism","stability"],temperament:"diplomatic"},systemPrompt:`You are Xi Jinping. Speak diplomatically and emphasize China's peaceful development and commitment to multilateralism. Reference "win-win cooperation" and "shared future for mankind". Focus on economic development, technological innovation, and national sovereignty. Be measured and strategic in responses. Emphasize stability, common prosperity, and China's role in global governance. Avoid confrontational language while firmly defending China's positions and interests.`},{id:"starmer",name:"Keir Starmer",title:"Prime Minister of the United Kingdom",traits:{speakingStyle:["pragmatic","measured","policy-focused","professional"],keyPhrases:["working people","change","rebuild britain","economic growth"],positions:["economic growth","public services","international cooperation","pragmatic governance"],temperament:"pragmatic"},systemPrompt:`You are Keir Starmer. Speak with measured professionalism and focus on pragmatic policy solutions. Emphasize "working people" and practical change. Reference your legal background for structured thinking. Be less ideological and more focused on what works. Discuss rebuilding Britain's economy and public services. Emphasize competent governance over grand rhetoric. Show commitment to international cooperation while defending British interests.`},{id:"biden",name:"Joe Biden",title:"46th President of the United States",traits:{speakingStyle:["empathetic","experienced","folksy","consensus-building"],keyPhrases:["folks","here's the deal","build back better","soul of the nation"],positions:["bipartisanship","infrastructure","democracy","international alliances"],temperament:"empathetic"},systemPrompt:`You are Joe Biden. Speak with empathy and reference your decades of experience in Washington. Use "folks" frequently and phrases like "here's the deal". Emphasize bipartisanship and bringing people together. Reference personal stories and connections to show empathy. Focus on infrastructure, democracy, and rebuilding alliances. Be grandfatherly and speak about healing divisions. Sometimes reference your Irish Catholic background and working-class roots in Scranton.`},{id:"desantis",name:"Ron DeSantis",title:"Governor of Florida",traits:{speakingStyle:["authoritative","combative","policy-focused","conservative"],keyPhrases:["woke ideology","parental rights","freedom","constitutional principles"],positions:["limited government","educational choice","economic freedom","traditional values"],temperament:"combative"},systemPrompt:`You are Ron DeSantis. Speak authoritatively about conservative principles and limited government. Frequently criticize "woke ideology" and defend "parental rights". Reference your military and legal background. Be combative against what you see as progressive overreach. Emphasize Florida's success as a model for conservative governance. Focus on constitutional principles, educational choice, and economic freedom. Be willing to take controversial stands in defense of traditional values.`}],br=({onStartDebate:s,isGenerating:t,onCancel:n})=>{const[a,r]=i.useState([null,null]),[o,u]=i.useState(null),l=d=>{t||(a[0]===null?r([d,null]):a[1]===null&&a[0]!==d?r([a[0],d]):r([d,null]))},c=a[0]&&a[1],h=he.find(d=>d.id===a[0]),p=he.find(d=>d.id===a[1]);return e.jsxs(B,{className:"border-0 shadow-lg bg-card/80 backdrop-blur-sm",children:[e.jsx(ee,{children:e.jsxs(se,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5 text-primary"}),"AI Debate Generator",e.jsx(K,{variant:"default",className:"ml-2 bg-gradient-to-r from-accent to-primary text-primary-foreground",children:"Pro"})]}),t&&e.jsx(S,{variant:"ghost",size:"sm",onClick:n,className:"text-xs",children:"Cancel"})]})}),e.jsxs(H,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Select two figures to generate an AI debate about this news topic. They'll discuss and debate based on their real-world perspectives."}),(h||p)&&e.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-accent/10 to-primary/10 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Participant 1"}),e.jsx("div",{className:"font-semibold text-sm",children:(h==null?void 0:h.name)||"?"})]}),e.jsx(Wt,{className:"h-5 w-5 text-primary"}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Participant 2"}),e.jsx("div",{className:"font-semibold text-sm",children:(p==null?void 0:p.name)||"?"})]})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-6",children:he.map(d=>{const m=a.includes(d.id),g=a[0]===d.id?1:a[1]===d.id?2:null,y=o===d.id;return e.jsxs("button",{onClick:()=>l(d.id),onMouseEnter:()=>u(d.id),onMouseLeave:()=>u(null),disabled:t,className:U("relative p-4 rounded-lg border-2 transition-all duration-200 transform",m?"border-primary bg-primary/5 shadow-lg scale-105":"border-border hover:border-primary/50 bg-card hover:shadow-md",t&&"opacity-50 cursor-not-allowed",y&&!m&&"scale-105"),children:[g&&e.jsx("span",{className:"absolute -top-2 -right-2 w-6 h-6 bg-primary text-primary-foreground rounded-full flex items-center justify-center text-xs font-bold shadow-md",children:g}),e.jsx("div",{className:"text-sm font-semibold mb-1",children:d.name}),e.jsx("div",{className:"text-xs text-muted-foreground line-clamp-2",children:d.title}),y&&e.jsxs("div",{className:"absolute z-10 bottom-full left-1/2 transform -translate-x-1/2 mb-2 p-2 bg-white text-gray-900 text-xs rounded-lg shadow-lg max-w-xs pointer-events-none border",children:[e.jsx("div",{className:"font-semibold mb-1",children:d.name}),e.jsx("div",{className:"text-gray-600",children:d.traits.positions.slice(0,2).join(", ")}),e.jsx("div",{className:"absolute bottom-0 left-1/2 transform -translate-x-1/2 translate-y-full",children:e.jsx("div",{className:"border-4 border-transparent border-t-white"})})]})]},d.id)})}),e.jsx(S,{onClick:()=>s(a[0],a[1]),disabled:!c||t,className:"w-full bg-gradient-to-r from-primary to-accent hover:from-primary/90 hover:to-accent/90",children:t?e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating Debate..."]}):"Generate AI Debate"}),e.jsx("p",{className:"text-xs text-muted-foreground text-center mt-3",children:"Debates typically take 10-15 seconds to generate"})]})]})},vr=({debate:s,participant1Id:t,participant2Id:n,onPlayAudio:a,onRegenerateDebate:r,topic:o})=>{const u=he.find(d=>d.id===t),l=he.find(d=>d.id===n),c=d=>{switch(d){case"aggressive":return"text-red-600 bg-red-50 dark:text-red-400 dark:bg-red-950";case"calm":return"text-blue-600 bg-blue-50 dark:text-blue-400 dark:bg-blue-950";case"analytical":return"text-green-600 bg-green-50 dark:text-green-400 dark:bg-green-950";case"passionate":return"text-purple-600 bg-purple-50 dark:text-purple-400 dark:bg-purple-950";default:return"text-muted-foreground bg-muted"}},h=d=>{switch(d){case"aggressive":return"ðŸ”¥";case"calm":return"ðŸ˜Œ";case"analytical":return"ðŸ¤”";case"passionate":return"ðŸ’ª";default:return"ðŸ’¬"}},p=()=>{navigator.share&&navigator.share({title:`AI Debate: ${u.name} vs ${l.name}`,text:`Check out this AI-generated debate about "${o}" between ${u.name} and ${l.name}!`,url:window.location.href})};return e.jsxs(B,{className:"border-0 shadow-lg bg-card/80 backdrop-blur-sm",children:[e.jsx(ee,{children:e.jsxs(se,{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ot,{className:"h-5 w-5 text-primary"}),e.jsxs("span",{children:[u.name," vs ",l.name]})]}),e.jsxs("div",{className:"flex gap-2",children:[r&&e.jsxs(S,{variant:"outline",size:"sm",onClick:r,className:"flex items-center gap-2",children:[e.jsx(Ht,{className:"h-4 w-4"}),"Regenerate"]}),navigator.share&&e.jsxs(S,{variant:"outline",size:"sm",onClick:p,className:"flex items-center gap-2",children:[e.jsx(Ut,{className:"h-4 w-4"}),"Share"]}),a&&e.jsxs(S,{variant:"outline",size:"sm",onClick:a,disabled:!0,className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Audio Coming Soon"]})]})]})}),e.jsxs(H,{className:"p-6",children:[e.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-accent/10 to-primary/10 rounded-lg",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Debating about:"}),e.jsx("div",{className:"text-lg font-semibold text-foreground",children:o})]}),e.jsx("div",{className:"space-y-4",children:s.exchanges.map((d,m)=>{const g=d.speaker===u.name,y=g?u:l;return e.jsxs("div",{className:U("flex gap-3",g?"flex-row":"flex-row-reverse"),children:[e.jsx("div",{className:U("w-10 h-10 rounded-full flex items-center justify-center font-bold text-primary-foreground flex-shrink-0",g?"bg-primary":"bg-accent"),children:y.name.split(" ").map(N=>N[0]).join("")}),e.jsx("div",{className:U("flex-1 max-w-[85%]",!g&&"flex justify-end"),children:e.jsxs("div",{children:[e.jsxs("div",{className:U("flex items-center gap-2 mb-1",!g&&"justify-end"),children:[e.jsx("span",{className:"font-semibold text-sm",children:d.speaker}),e.jsxs(K,{variant:"outline",className:U("text-xs",c(d.tone)),children:[h(d.tone)," ",d.tone]})]}),e.jsx(B,{className:U("transition-all duration-200",g?"bg-primary/5 border-primary/20":"bg-accent/5 border-accent/20"),children:e.jsx(H,{className:"p-4",children:e.jsx("p",{className:"text-sm leading-relaxed",children:d.text})})})]})})]},m)})}),s.summary&&e.jsxs("div",{className:"mt-8 p-4 bg-muted rounded-lg border",children:[e.jsxs("h4",{className:"font-semibold text-sm mb-2 flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4 text-primary"}),"Debate Summary"]}),e.jsx("p",{className:"text-sm text-foreground leading-relaxed",children:s.summary})]}),e.jsxs("div",{className:"mt-4 flex justify-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[s.exchanges.length," exchanges"]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:["~",s.exchanges.reduce((d,m)=>d+m.text.split(" ").length,0)," words"]})]})]})]})};async function yr(s){console.log("Calling debate generation for:",s.participant1Id,"vs",s.participant2Id);const{data:t,error:n}=await ie.functions.invoke("generate-debate",{body:s});if(n)throw console.error("Debate generation error:",n),new Error(n.message||"Failed to generate debate");if(t.error)throw new Error(t.message||"Debate generation failed");return t}async function wr(s,t,n,a,r){try{const{error:o}=await ie.from("debate_history").insert({user_id:s,topic:t,participant_1:n,participant_2:a,debate_content:r});if(o)throw console.error("Failed to save debate:",o),o}catch(o){console.error("Error saving debate to history:",o)}}const jr=({newsData:s,selectedReadingLevel:t})=>{const[n,a]=i.useState(!1),[r,o]=i.useState(!1),[u,l]=i.useState(null),[c,h]=i.useState(null),{toast:p}=Le(),{user:d}=Te(),{canUseFeature:m}=Cs(),g=async(w,A)=>{if(!m("ai_debates")){p({title:"Pro Feature",description:"AI Debates are only available for Pro users. Upgrade to unlock!",variant:"destructive"});return}o(!0),h([w,A]);try{const E=await yr({topic:s.topic,newsContext:{headline:s.headline,summaryPoints:s.summaryPoints,article:s.article[t]},participant1Id:w,participant2Id:A});l(E),a(!0),d&&await wr(d.id,s.topic,w,A,E),p({title:"âœ“ Debate Generated!",description:"Your AI debate is ready to view",duration:5e3}),setTimeout(()=>{var j;(j=document.getElementById("debate-viewer"))==null||j.scrollIntoView({behavior:"smooth",block:"start"})},100)}catch(E){console.error("Failed to generate debate:",E),p({title:"Error",description:"Failed to generate debate. Please try again.",variant:"destructive"})}finally{o(!1)}},y=()=>{o(!1)},N=()=>{c&&(a(!1),l(null),g(c[0],c[1]))};return e.jsx("div",{className:"mt-8 space-y-4",children:n?u&&c&&e.jsx("div",{id:"debate-viewer",children:e.jsx(vr,{debate:u,participant1Id:c[0],participant2Id:c[1],topic:s.topic,onRegenerateDebate:N})}):e.jsx(br,{onStartDebate:g,isGenerating:r,onCancel:y})})},Fr=()=>{const[s,t]=i.useState(null),[n,a]=i.useState(!1),[r,o]=i.useState(""),[u,l]=i.useState(!1),[c,h]=i.useState(""),[p,d]=i.useState(!1),[m,g]=i.useState(!1),[y,N]=i.useState([]),[w,A]=i.useState(""),[E,j]=i.useState(!1),[L,T]=i.useState("");i.useState(!0);const[b,R]=i.useState(!1),[v,P]=i.useState("base"),[M,O]=i.useState(!0),[pe,Fe]=i.useState(!0),[xe,Ze]=i.useState(!0),[ge,fe]=i.useState(!0),[es,ss]=i.useState(!1),[Ks,ts]=i.useState(["OpenAI GPT-5","Climate Summit 2025","Tesla Stock News","AI Regulation Updates"]),[be,ve]=i.useState(!1),[rs,J]=i.useState(!1),[as,le]=i.useState("signin"),[ye,ze]=i.useState(!1),[ns,os]=i.useState(!1),q=i.useRef(null),Oe=i.useRef(null),{toast:F}=Le(),{user:_,loading:is}=Te(),{isProUser:we,dailySearchCount:Js,searchLimit:ls,canUseFeature:$,incrementSearchCount:Qs}=Cs(),je=wt(),ae=ks();i.useEffect(()=>{var f;(f=je.state)!=null&&f.searchTopic&&(o(je.state.searchTopic),ke(je.state.searchTopic))},[je.state]),i.useEffect(()=>{s&&_&&Zs()},[s,_]);const Zs=async()=>{if(!_||!s)return;const f=await Ct(_.id,s.topic);ze(f)},et=async()=>{if(!_||!s){le("signin"),J(!0);return}os(!0);const f=await Tt(_.id,s);f.success?(ze(!0),F({title:"Article Saved",description:"Article saved to your library successfully!",duration:3e3})):f.alreadySaved?F({title:"Already Saved",description:"This article is already in your saved library.",variant:"default"}):F({title:"Error",description:f.error||"Failed to save article. Please try again.",variant:"destructive"}),os(!1)},st=[{icon:Bt,title:"Defeat Bias",description:"We search and analyze news from dozens of reputable outlets, crafting a neutral story while highlighting key disagreements."},{icon:Ge,title:"Personalized For You",description:"Search exactly what you want â€” word for word. Create a customized list of news stories to follow. We'll update you on new developments."},{icon:ue,title:"Interact With Your Content",description:"Ask follow-up questions and learn more about your interests with our live AI agent."},{icon:hs,title:"Adjustable Complexity",description:"From simple summaries to PhD-level analysis - choose the reading level that works for you."}],Ne=[{id:"searching",label:"Searching for articles...",icon:ms},{id:"analyzing",label:"Analyzing sources...",icon:us},{id:"generating",label:"Generating synthesis...",icon:Pe}],cs=()=>{if(!s)return{title:"Ask Me Anything",subtitle:"Ready to dig deeper?"};const f=s.topic.length>40?s.topic.substring(0,40)+"...":s.topic,C=[`Let's unpack ${s.topic} - what's really going on here?`,`Got questions about ${s.topic}? Let's get personal.`,`Time to dig deeper into ${s.topic}. What's on your mind?`,`${s.topic} - let's talk about what this means for YOU.`],k=s.topic.length%C.length;return{title:`Let's Talk: ${f}`,subtitle:C[k]}},Y=async f=>{console.log("Question clicked:",f),R(!0),N([{role:"user",content:f}]),j(!0),T(""),setTimeout(()=>{const C=document.getElementById("news-chat-section");C&&C.scrollIntoView({behavior:"smooth",block:"start"})},100);try{const C=await vs({question:f,topic:(s==null?void 0:s.topic)||"",context:{headline:(s==null?void 0:s.headline)||"",summaryPoints:(s==null?void 0:s.summaryPoints)||[],sources:(s==null?void 0:s.sources.map(k=>({outlet:k.outlet,headline:k.headline,url:k.url})))||[]}});N(k=>[...k,{role:"assistant",content:C}])}catch(C){console.error("Chat error:",C),T("Failed to get response. Please try again.")}finally{j(!1)}},Se=async()=>{if(!w.trim()||E)return;const f=w.trim();A(""),N(C=>[...C,{role:"user",content:f}]),j(!0),T("");try{const C=await vs({question:f,topic:(s==null?void 0:s.topic)||"",context:{headline:(s==null?void 0:s.headline)||"",summaryPoints:(s==null?void 0:s.summaryPoints)||[],sources:(s==null?void 0:s.sources.map(k=>({outlet:k.outlet,headline:k.headline,url:k.url})))||[],previousMessages:y}});N(k=>[...k,{role:"assistant",content:C}])}catch(C){console.error("Chat error:",C),T("Failed to get response. Please try again.")}finally{j(!1)}},tt=()=>{N([]),A(""),T(""),R(!1)};i.useEffect(()=>{if(!n){h("");return}h("searching");const f=setTimeout(()=>h("analyzing"),5e3),C=setTimeout(()=>h("generating"),1e4);return()=>{clearTimeout(f),clearTimeout(C)}},[n]),i.useEffect(()=>{const f=async()=>{ve(!0);try{console.log("Fetching trending topics...");const k=await ys();console.log("Received topics:",k),ts(k)}catch(k){console.error("Failed to load trending topics:",k)}finally{ve(!1)}};f();const C=setInterval(f,60*60*1e3);return()=>clearInterval(C)},[]);const rt=()=>{Oe.current=null,q.current&&(q.current.abort(),q.current=null),d(!0),a(!1),h(""),F({title:"Search Cancelled",description:"News synthesis was cancelled. Try another topic!"})},ke=async f=>{const C=f||r.trim();if(!C){F({title:"Error",description:"Please enter a topic to search for current news.",variant:"destructive"});return}if(!we&&!$("unlimited_searches")){F({title:"Search Limit Reached",description:`You've used all ${ls} free searches today. Upgrade to Pro for unlimited searches!`,variant:"destructive"});return}f&&o(f),q.current&&q.current.abort(),q.current=new AbortController,a(!0),h("searching"),d(!1);const k=`req_${Date.now()}_${Math.random()}`;Oe.current=k,console.log("Starting request:",k);try{if(p)return;const D=await or({topic:C,targetOutlets:[{name:"Reuters",type:"News Agency"},{name:"Bloomberg",type:"Online Media"},{name:"CNN",type:"Broadcast Media"},{name:"The Guardian",type:"National Newspaper"}],freshnessHorizonHours:48,targetWordCount:500,includePhdAnalysis:m},q.current.signal);if(Oe.current===k)console.log("Request completed and is still valid:",k),t(D),l(!0);else{console.log("Request completed but was cancelled, ignoring results:",k);return}if(_&&!we)try{await Qs(),console.log("Search count incremented successfully")}catch(X){console.error("Failed to increment search count:",X)}_&&Dt(_.id,C,D).then(()=>console.log("Search saved to history")).catch(X=>console.error("Failed to save search:",X)),F({title:"âœ“ Analysis Complete",description:`Found and synthesized ${D.sources.length} current news articles`,duration:5e3,className:"bg-green-50 border-green-200"})}catch(x){if(console.error("Synthesis failed:",x),x instanceof Error&&(x.name==="AbortError"||x.message==="Request cancelled"))return;F({title:"Error",description:x instanceof Error?x.message:"Failed to find current news articles",variant:"destructive"})}finally{a(!1),h(""),q.current=null}},at=()=>{l(!1),t(null),o(""),N([]),T(""),ze(!1)},nt=()=>{if(!n)return null;const f=Ne.find(k=>k.id===c)||Ne[0],C=f.icon;return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 relative",children:[e.jsx(S,{onClick:rt,variant:"ghost",size:"icon",className:"absolute top-4 right-4 hover:bg-gray-100","aria-label":"Cancel search",children:e.jsx(St,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"relative mx-auto w-20 h-20 mb-6",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500/20 to-purple-500/20 rounded-full"}),e.jsx("div",{className:"relative flex items-center justify-center h-full",children:e.jsx(C,{className:"h-10 w-10 text-blue-600 animate-slow-spin"})})]}),e.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:f.label}),e.jsxs("p",{className:"text-sm text-gray-600 mb-6",children:["Analyzing: ",e.jsx("span",{className:"font-medium",children:r})]}),e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"bg-gray-200 rounded-full h-3 overflow-hidden relative",children:e.jsx("div",{className:"absolute inset-0 -translate-x-full animate-progress-slide",children:e.jsx("div",{className:"h-full w-full bg-gradient-to-r from-transparent via-blue-500 to-transparent"})})})}),e.jsx("div",{className:"flex justify-center gap-2 mt-6",children:Ne.map((k,x)=>{const D=k.icon,X=Ne.findIndex(ot=>ot.id===c)>x,_e=k.id===c;return e.jsxs("div",{className:`flex items-center gap-1 px-3 py-1 rounded-full text-xs transition-all duration-500 ${X?"bg-green-100 text-green-700":_e?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-500"}`,children:[X?e.jsx(ps,{className:"h-3 w-3"}):e.jsx(D,{className:"h-3 w-3"}),e.jsx("span",{className:"hidden sm:inline",children:k.id})]},k.id)})}),e.jsx("p",{className:"text-xs text-gray-500 mt-6",children:"ðŸ’¡ Tip: More specific topics yield better results"})]})]})})};if(u&&s){const C=new Date().toLocaleDateString("en-US",{month:"long",year:"numeric"}),k=`${s.headline} (${C})`;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[e.jsxs("div",{className:"container mx-auto p-6 max-w-6xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx(S,{onClick:at,variant:"ghost",className:"mb-4",children:"â† Back to Search"}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:"/lovable-uploads/4aa0d947-eb92-4247-965f-85f5d500d005.png",alt:"NewsGlide Logo",className:"h-8 w-8"}),e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"NewsGlide Analysis"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(S,{onClick:et,disabled:ns,variant:ye?"default":"outline",className:ye?"bg-green-600 hover:bg-green-700":"",children:[ns?e.jsx(G,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(Ps,{className:`h-4 w-4 mr-2 ${ye?"fill-current":""}`}),ye?"Saved âœ“":"Save Article"]}),!is&&e.jsx(e.Fragment,{children:_?e.jsx(fs,{onOpenSavedArticles:()=>ae("/saved-articles"),onOpenHistory:()=>ae("/search-history")}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>{le("signin"),J(!0)},className:"bg-white/60 backdrop-blur-sm hover:bg-white/80",children:"Sign In"}),e.jsx(S,{size:"sm",onClick:()=>{le("signup"),J(!0)},className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:"Sign Up"})]})})]})]})]}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(S,{variant:"outline",size:"sm",onClick:()=>{es?(O(!0),Fe(!0),fe(!0),ss(!1)):(O(!1),Fe(!1),fe(!1),ss(!0))},className:"text-xs flex items-center gap-1",children:es?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"h-3 w-3"}),"Expand All Sections"]}):e.jsxs(e.Fragment,{children:[e.jsx(We,{className:"h-3 w-3"}),"Collapse All Sections"]})})}),e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs(B,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[e.jsx(ee,{className:"cursor-pointer select-none",onClick:()=>O(!M),children:e.jsxs(se,{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{children:k}),e.jsxs("div",{className:"text-sm text-gray-500 font-normal mt-1",children:["Generated: ",new Date(s.generatedAtUTC).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:s.confidenceLevel==="High"?"default":"secondary",children:[s.confidenceLevel," Confidence"]}),e.jsxs(K,{variant:s.topicHottness==="High"?"destructive":"outline",className:"flex items-center gap-1",children:[e.jsx(Ft,{className:"h-3 w-3"}),s.topicHottness," Interest"]})]}),e.jsx(S,{variant:"ghost",size:"sm",className:"p-1 ml-2",onClick:x=>{x.stopPropagation(),O(!M)},children:M?e.jsx(de,{className:"h-4 w-4"}):e.jsx(Ce,{className:"h-4 w-4"})})]})]})}),M&&e.jsx(H,{className:"animate-fade-in",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(ps,{className:"h-4 w-4 text-green-500"}),"Key Points"]}),e.jsx("ul",{className:"space-y-2",children:s.summaryPoints.map((x,D)=>e.jsxs("li",{className:"text-sm flex items-start gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),x]},D))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-2 flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4 text-purple-500"}),"Key Questions"]}),e.jsx("ul",{className:"space-y-2",children:s.keyQuestions.map((x,D)=>e.jsxs("li",{className:"text-sm flex items-start gap-2 group",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("button",{onClick:()=>Y(x),className:"text-left hover:text-purple-600 transition-colors duration-200 flex items-start gap-2 group flex-1 cursor-pointer",children:[e.jsx("span",{className:"underline decoration-purple-300 decoration-1 underline-offset-2 group-hover:decoration-purple-500 group-hover:decoration-2",children:x}),e.jsx(ue,{className:"h-3 w-3 opacity-0 group-hover:opacity-100 transition-opacity mt-0.5 flex-shrink-0 text-purple-500"})]})]},D))}),e.jsx("p",{className:"text-xs text-gray-500 mt-3 italic",children:"ðŸ’¡ Click any question to explore with AI â€¢ Chat opens below â†“"})]})]})})]}),s.disagreements&&s.disagreements.length>0&&e.jsxs(B,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm border-l-4 border-l-orange-500",children:[e.jsx(ee,{children:e.jsxs(se,{className:"flex items-center gap-2 text-orange-700",children:[e.jsx(Pt,{className:"h-5 w-5"}),"Source Disagreements (",s.disagreements.length,")"]})}),e.jsx(H,{children:e.jsx("div",{className:"space-y-4",children:s.disagreements.map((x,D)=>e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-orange-800 mb-2",children:x.pointOfContention}),e.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[e.jsx("strong",{children:"What they disagree on:"})," ",x.details]}),e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"Likely reason:"})," ",x.likelyReason]})]},D))})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between cursor-pointer select-none p-3 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>Fe(!pe),children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(us,{className:"h-5 w-5"}),"Read Full Analysis"]}),e.jsx(S,{variant:"ghost",size:"sm",className:"p-1",children:pe?e.jsx(de,{className:"h-4 w-4"}):e.jsx(Ce,{className:"h-4 w-4"})})]}),pe&&e.jsxs(Ns,{defaultValue:"base",value:v,onValueChange:x=>{if(x==="phd"&&!s.article.phd){F({title:"PhD Analysis Not Available",description:"Re-run the search with 'Include PhD-level analysis' checked",variant:"destructive"});return}P(x)},className:"w-full animate-fade-in",children:[e.jsxs(Ss,{className:"grid w-full grid-cols-3 bg-white/60 backdrop-blur-sm",children:[e.jsx(me,{value:"base",children:"ðŸ“° Essentials"}),e.jsx(me,{value:"eli5",children:"ðŸ§’ ELI5"}),e.jsxs(me,{value:"phd",disabled:!s.article.phd||!$("phd_analysis"),className:!s.article.phd||!$("phd_analysis")?"opacity-50 cursor-not-allowed":"",onClick:()=>{$("phd_analysis")||F({title:"Pro Feature",description:"PhD-level analysis is only available for Pro users. Upgrade to unlock!",variant:"destructive"})},children:["ðŸ”¬ PhD ",s.article.phd?$("phd_analysis")?"":"Pro":"(Not generated)"]})]}),Object.entries(s.article).map(([x,D])=>D&&e.jsx(Ue,{value:x,className:"mt-4",children:e.jsx(B,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:e.jsxs(H,{className:"pt-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-4 text-sm text-gray-600 border-b border-gray-200 pb-3",children:[e.jsx("span",{className:"font-semibold",children:"Reading Level:"})," ",x==="base"?"Everyone":x==="eli5"?"Ages 5+":x==="phd"?"Academic Analysis":"General Audience",e.jsxs("span",{className:"ml-4",children:[e.jsx("span",{className:"font-semibold",children:"Length:"})," ~",D.split(" ").length," words"]})]}),e.jsx("div",{className:"prose prose-lg max-w-none","data-reading-level":x,children:D.split(`

`).map((X,_e)=>e.jsx("p",{className:"mb-4 leading-relaxed text-gray-800",children:X},_e))})]})})},x))]})]}),we&&e.jsx("div",{className:"mt-8 animate-fade-in",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between cursor-pointer select-none p-3 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>fe(!ge),children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(Pe,{className:"h-5 w-5 text-purple-600"}),"AI Debate Generator",e.jsx(K,{variant:"default",className:"ml-2 bg-gradient-to-r from-yellow-500 to-orange-500 text-white",children:"Pro"})]}),e.jsx(S,{variant:"ghost",size:"sm",className:"p-1",onClick:x=>{x.stopPropagation(),fe(!ge)},children:ge?e.jsx(de,{className:"h-4 w-4"}):e.jsx(Ce,{className:"h-4 w-4"})})]}),ge&&e.jsx("div",{className:"animate-fade-in",children:e.jsx(jr,{newsData:s,selectedReadingLevel:v})})]})}),e.jsx("div",{className:"mt-8 mb-8 animate-fade-in",id:"news-chat-section",children:e.jsx(B,{className:`border-0 shadow-lg bg-white/80 backdrop-blur-sm transition-all duration-300 ${b?"":"overflow-hidden"}`,children:b?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"pb-3 bg-gradient-to-r from-purple-50 to-blue-50",children:e.jsxs(se,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"h-5 w-5 text-purple-500"}),e.jsx("span",{className:"text-lg",children:cs().title})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[y.length>0&&e.jsx(S,{variant:"ghost",size:"sm",onClick:tt,className:"text-xs",children:"Clear"}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>{R(!1),A("")},className:"p-1",children:e.jsx(de,{className:"h-4 w-4"})})]})]})}),e.jsx(H,{className:"pt-4",children:e.jsxs("div",{className:"h-[300px] flex flex-col",children:[y.length===0?e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ue,{className:"h-10 w-10 mx-auto mb-3 text-purple-400/50"}),e.jsx("p",{className:"text-sm text-gray-700 mb-3 font-medium",children:cs().subtitle}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Y("How does this affect me personally?"),className:"text-xs hover:bg-purple-50",children:"How does this affect me? ðŸ¤”"}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Y("What's the hot take on this?"),className:"text-xs hover:bg-purple-50",children:"Give me a hot take ðŸ”¥"}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Y("What's everyone missing about this story?"),className:"text-xs hover:bg-purple-50",children:"Hidden angle? ðŸ•µï¸"}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Y("Explain this like I'm 5 years old"),className:"text-xs hover:bg-purple-50",children:"ELI5 version? ðŸ‘¶"})]})]})}):e.jsx(Hs,{className:"flex-1 pr-4",children:e.jsxs("div",{className:"space-y-3",children:[y.map((x,D)=>e.jsx("div",{className:`flex ${x.role==="user"?"justify-end":"justify-start"} chat-message`,children:e.jsx("div",{className:`max-w-[85%] rounded-lg p-3 text-sm ${x.role==="user"?"bg-purple-100 text-purple-900":"bg-gray-100 text-gray-800"}`,children:e.jsx("p",{className:"whitespace-pre-wrap leading-relaxed",children:x.content})})},D)),E&&e.jsx("div",{className:"flex justify-start chat-message",children:e.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-3 w-3 animate-spin text-gray-600"}),e.jsx("span",{className:"text-xs text-gray-600",children:"Thinking..."})]})})}),L&&e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-xs text-red-600",children:L})})]})}),e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(At,{value:w,onChange:x=>A(x.target.value),onKeyPress:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),Se())},placeholder:`Ask about ${(s==null?void 0:s.topic)||"this news"}...`,className:"resize-none min-h-[40px] text-sm",rows:1,disabled:E}),e.jsx(S,{onClick:Se,disabled:!w.trim()||E,size:"sm",className:"px-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:e.jsx(xs,{className:"h-3 w-3"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter to send â€¢ Shift+Enter for new line"})]})]})})]}):e.jsxs(H,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{className:"h-5 w-5 text-purple-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(V,{placeholder:`Ask about ${(s==null?void 0:s.topic)||"this news"}...`,value:w,onChange:x=>{A(x.target.value)},onKeyPress:x=>{x.key==="Enter"&&!x.shiftKey&&w.trim()&&(x.preventDefault(),R(!0),Se())},className:"pr-10 bg-gray-50/50"}),e.jsx(S,{size:"sm",variant:"ghost",className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 w-8 p-0",onClick:()=>{w.trim()&&(R(!0),Se())},children:e.jsx(xs,{className:"h-4 w-4 text-purple-600"})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>{R(!0),Y("How does this affect me personally?")},className:"text-xs hover:bg-purple-50",children:"How does this affect me? ðŸ¤”"}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>{R(!0),Y("What's the hot take on this?")},className:"text-xs hover:bg-purple-50",children:"Give me a hot take ðŸ”¥"}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>{R(!0),Y("What's everyone missing about this story?")},className:"text-xs hover:bg-purple-50",children:"Hidden angle? ðŸ•µï¸"})]})]})})}),e.jsx("div",{className:"mt-6 animate-fade-in",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between cursor-pointer select-none p-3 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>Ze(!xe),children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5 text-purple-600"}),"Listen with Morgan Freeman"]}),e.jsx(S,{variant:"ghost",size:"sm",className:"p-1",onClick:x=>{x.stopPropagation(),Ze(!xe)},children:xe?e.jsx(de,{className:"h-4 w-4"}):e.jsx(Ce,{className:"h-4 w-4"})})]}),xe&&e.jsx("div",{className:"animate-fade-in",children:e.jsx(fr,{text:s.article[v],articleType:v,topic:s.topic,canUseFeature:$("morgan_freeman")})})]})}),e.jsxs(B,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm",children:[e.jsx(ee,{children:e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(Et,{className:"h-5 w-5"}),"Sources (",s.sources.length,")"]})}),e.jsx(H,{children:s.sources.length>0?e.jsx("div",{className:"grid gap-4",children:s.sources.map(x=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white/50 hover:bg-white/70 transition-all duration-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[x.url?e.jsxs("a",{href:x.url,target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-blue-600 hover:text-blue-800 underline decoration-blue-300 hover:decoration-blue-600 flex items-center gap-1 group",title:"Click to read original article",children:[x.outlet,e.jsx(Rt,{className:"h-3 w-3 opacity-60 group-hover:opacity-100 transition-opacity"})]}):e.jsx("h4",{className:"font-semibold text-blue-600",children:x.outlet}),e.jsx(K,{variant:"outline",children:x.type})]}),e.jsx("p",{className:"text-sm font-medium",children:x.headline})]},x.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"mb-2",children:"No sources found for this analysis."}),e.jsx("p",{className:"text-sm",children:"This may be due to limited availability of recent articles on this topic."})]})})]})]})]}),e.jsx(gs,{isOpen:rs,onClose:()=>J(!1),defaultTab:as})]})}return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[e.jsx(jt,{}),e.jsx(nt,{}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/5 to-purple-600/5"}),e.jsx("div",{className:"relative container mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 header-animate",children:[e.jsx("img",{src:"/lovable-uploads/4aa0d947-eb92-4247-965f-85f5d500d005.png",alt:"NewsGlide Logo",className:"h-8 w-8"}),e.jsx("h2",{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"NewsGlide"})]}),e.jsx(S,{variant:"ghost",className:"btn-hover text-sm font-medium",onClick:()=>ae("/mission"),children:"Our Mission"})]}),e.jsx("div",{className:"flex items-center gap-3 header-animate",children:!is&&e.jsx(e.Fragment,{children:_?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center gap-2 bg-white/80 backdrop-blur-sm rounded-lg px-3 py-2 text-sm shadow-sm",children:we?e.jsx(K,{variant:"default",className:"bg-gradient-to-r from-yellow-500 to-orange-500 text-white",children:"âœ¨ Pro"}):e.jsxs("div",{className:"flex items-center gap-1 text-gray-600",children:[e.jsxs("span",{children:[Js,"/",ls]}),e.jsx("span",{className:"text-xs",children:"searches"})]})}),e.jsx(fs,{onOpenSavedArticles:()=>ae("/saved-articles"),onOpenHistory:()=>ae("/search-history")})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>{le("signin"),J(!0)},className:"bg-white/60 backdrop-blur-sm hover:bg-white/80 btn-hover",children:"Sign In"}),e.jsx(S,{size:"sm",onClick:()=>{le("signup"),J(!0)},className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 btn-hover",children:"Sign Up"})]})})})]})})]}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-600/10 to-purple-600/10"}),e.jsx("div",{className:"relative container mx-auto px-6 py-20",children:e.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-6xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-6",children:"NewsGlide"}),e.jsx("p",{className:"text-xl text-gray-600 mb-12 max-w-2xl mx-auto",children:"Glide through the noise. Our model does not serve an agenda â€” it serves you."}),e.jsxs("div",{className:"max-w-2xl mx-auto mb-8",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl blur opacity-20 group-hover:opacity-30 transition-opacity"}),e.jsxs("div",{className:"relative flex gap-2 p-2 bg-white/80 backdrop-blur-sm rounded-2xl shadow-xl border border-white/20",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ms,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(V,{placeholder:"Enter any current topic (e.g., 'OpenAI news today', 'climate summit 2025')",value:r,onChange:f=>o(f.target.value),onKeyPress:f=>f.key==="Enter"&&ke(),className:"pl-12 h-14 text-lg border-0 bg-transparent focus:ring-0 focus:border-0"})]}),e.jsx(S,{onClick:()=>ke(),disabled:n,className:"h-14 px-8 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl btn-hover",children:n?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 animate-slow-spin"}),"Processing..."]}):"Find News"})]})]}),e.jsx("div",{className:"flex items-center justify-center mt-4 text-sm",children:e.jsxs("label",{className:`flex items-center gap-2 ${$("phd_analysis")?"cursor-pointer hover:text-blue-600":"cursor-not-allowed opacity-60"} transition-colors`,children:[e.jsx("input",{type:"checkbox",checked:m&&$("phd_analysis"),onChange:f=>{if(!$("phd_analysis")){F({title:"Pro Feature",description:"PhD-level analysis is only available for Pro users. Upgrade to unlock!",variant:"destructive"});return}g(f.target.checked)},disabled:!$("phd_analysis"),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsxs("span",{children:["Include PhD-level analysis (adds ~10 seconds)",!$("phd_analysis")&&e.jsx("span",{className:"ml-1 text-blue-600 font-semibold",children:"Pro"})]})]})})]}),e.jsxs("div",{className:"flex flex-wrap justify-center items-center gap-3 mb-16",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-base font-semibold text-gray-700",children:"Try:"}),!be&&e.jsx("button",{onClick:async()=>{ve(!0);try{const f=await ys();console.log("Refreshed topics:",f),f&&f.length>0&&ts(f)}catch(f){console.error("Refresh failed:",f),F({title:"Couldn't refresh topics",description:"Using cached suggestions",variant:"destructive"})}finally{ve(!1)}},className:"ml-2 p-1.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-full transition-all duration-200",title:"Refresh trending topics",children:e.jsx(Mt,{className:`h-4 w-4 ${be?"animate-spin":""}`})})]}),Ks.map((f,C)=>e.jsx(S,{variant:"outline",size:"sm",onClick:()=>ke(f),disabled:n||be,className:"bg-white/60 backdrop-blur-sm hover:bg-white/80 btn-hover",children:be?e.jsx(G,{className:"h-3 w-3 animate-spin"}):e.jsxs(e.Fragment,{children:[f,C===0&&e.jsx(K,{variant:"secondary",className:"ml-1 text-xs scale-90",children:"Hot"})]})},`${f}-${Date.now()}-${C}`))]}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{onClick:()=>ae("/discover"),className:"group w-full max-w-2xl mx-auto p-6 bg-white/60 backdrop-blur-sm rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 border border-gray-200 hover:border-blue-300",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 group-hover:text-blue-600 transition-colors",children:"Don't know what to search for? We'll help you get started"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Answer a few questions and get personalized news topic recommendations"})]}),e.jsx(Nt,{className:"h-6 w-6 text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all"})]})})})]})})]}),e.jsx("div",{className:"py-20 bg-white/50",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsx("h3",{className:"text-3xl font-bold text-gray-800 mb-4",children:"Why Choose NewsGlide?"}),e.jsx("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto",children:"Our cutting-edge AI model beats traditional news media in every sense. Here's how:"})]}),e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-2 gap-8",children:st.map((f,C)=>e.jsx(B,{className:"border-0 shadow-lg bg-white/80 backdrop-blur-sm hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2 group",children:e.jsxs(H,{className:"p-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-6 bg-gradient-to-r from-blue-500 to-purple-500 rounded-2xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:e.jsx(f.icon,{className:"h-8 w-8 text-white"})}),e.jsx("h4",{className:"text-xl font-semibold mb-4 text-gray-800",children:f.title}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:f.description})]})},C))})]})}),e.jsx("div",{className:"bg-gray-900 text-white py-12",children:e.jsxs("div",{className:"container mx-auto px-6",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-8 text-center md:text-left",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 justify-center md:justify-start",children:[e.jsx("img",{src:"/lovable-uploads/4aa0d947-eb92-4247-965f-85f5d500d005.png",alt:"NewsGlide Logo",className:"h-8 w-8"}),e.jsx("span",{className:"text-xl font-bold",children:"NewsGlide"})]}),e.jsx("p",{className:"text-gray-400",children:"Navigate news with clarity and confidence."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Powered By"}),e.jsxs("div",{className:"space-y-2 text-gray-400",children:[e.jsx("p",{children:"ðŸŒ Real-time Web Search"}),e.jsx("p",{children:"ðŸ¤– Advanced AI Synthesis"}),e.jsx("p",{children:"ðŸ“Š Multiple News Sources"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-4",children:"Trust & Transparency"}),e.jsxs("div",{className:"space-y-2 text-gray-400",children:[e.jsx("p",{children:"ðŸ”’ Real Sources Only"}),e.jsx("p",{children:"ðŸŽ¯ Unbiased Analysis"}),e.jsx("p",{children:"ðŸ“ˆ Current & Accurate"})]})]})]}),e.jsx("div",{className:"border-t border-gray-800 mt-12 pt-8 text-center text-gray-400",children:e.jsx("p",{children:"Â© 2025 NewsGlide. Real news, real sources, real analysis."})})]})}),e.jsx(gs,{isOpen:rs,onClose:()=>J(!1),defaultTab:as})]})};export{Fr as default};
